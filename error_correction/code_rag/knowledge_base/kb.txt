[Keyword]: kb

[Design Category]: Interface Circuits

[Design Function Description]:  
The design is a keyboard interface circuit that processes data received from a PS/2 keyboard. It extracts the real bytes from the received packets of data, excluding break codes, and stores them in a FIFO buffer for further processing.

[Input Signal Description]:  
- `clk`: Clock signal used for synchronization.  
- `rst_n`: Active-low reset signal to initialize the system.  
- `ps2d`: PS/2 data line input from the keyboard.  
- `ps2c`: PS/2 clock line input from the keyboard.  
- `rd_fifo`: Read enable signal for the FIFO buffer to retrieve data.

[Output Signal Description]:  
- `rd_data[8:0]`: 9-bit output data read from the FIFO buffer, representing the real bytes extracted from the PS/2 data.  
- `fifo_empty`: Signal indicating whether the FIFO buffer is empty.  
- `breakcode`: Signal indicating the detection of a break code in the data stream.






[Design Detail]:
`timescale 1ns / 1ps

module kb(   //extract only the real bytes from received packets of data(no break code)
	input clk,rst_n,
	input ps2d,ps2c,
	input rd_fifo,
	output [8:0] rd_data, //{shift,data}
	output fifo_empty
    );
	 wire[10:0] dout;
	 wire rx_dont_tick;
	 wire wr;
	 wire [8:0] wr_data;
	 
 
	 ps2_rx m0
	 (
		.clk(clk),
		.rst_n(rst_n),
		.rx_en(1),
		.ps2d(ps2d),
		.ps2c(ps2c),
		.dout(dout),
		.rx_done_tick(rx_done_tick)
    );
	 
	 kb_data m1
	 (
		.clk(clk),
		.rst_n(rst_n),
		.rx_done_tick(rx_done_tick),
		.din(dout[8:1]),
		.wr(wr),
		.wr_data(wr_data)
    );
	 
	  fifo #(.W(4),.B(9)) m2
	(
		.clk(clk),
		.rst_n(rst_n),
		.wr(wr),
		.rd(rd_fifo), //
		.wr_data(wr_data),
		.rd_data(rd_data),//
		.full(),
		.empty(fifo_empty) //
    );
	 
endmodule


